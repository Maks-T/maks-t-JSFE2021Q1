(()=>{"use strict";class e{constructor(e="div",t=[]){this.element=document.createElement(e),this.element.classList.add(...t)}render(e){e.appendChild(this.element)}}class t extends e{constructor(t){super("footer",["footer"]),this.id=t,this.renderFooterElements=()=>{this.renderFooterWrapper(),this.renderFooterLinks()},this.renderFooterWrapper=()=>{this.footerWrapper=new e("div",["footer__wrapper"]),this.footerWrapper.render(this.element)},this.renderFooterLinks=()=>{this.githubLink=document.createElement("a"),this.githubLink.classList.add("footer__link-github"),this.githubLink.innerHTML="Maxim Tsatsura",this.githubLink.href="https://github.com/Maks-T",this.githubLink.setAttribute("target","_blank"),this.githubLink.setAttribute("rel","noopener noreferrer"),this.footerWrapper.element.appendChild(this.githubLink),this.rssLink=document.createElement("a"),this.rssLink.classList.add("footer__link-rss"),this.rssLink.innerHTML="21",this.rssLink.href="https://rs.school/js/",this.rssLink.setAttribute("target","_blank"),this.rssLink.setAttribute("rel","noopener noreferrer"),this.footerWrapper.element.appendChild(this.rssLink)},this.initFooter=()=>{this.element.id=this.id},this.initFooter(),this.renderFooterElements()}}class s{}s.onClickBtnLogin=()=>{};class i extends e{constructor(e){super("div",["nav-items"]),this.listLinksOuterHtml=e,this.items=[],this.renderLinks=()=>{this.createMainLink(),this.createLinks(),this.createRepeatLink(),this.createBtnLogin()},this.createMainLink=()=>{this.createLink("Main Page","categories",["nav-item","active"])},this.createLinks=()=>{this.listLinksOuterHtml.forEach(((e,t)=>{this.createLink(e,String(t+1),["nav-item"])}))},this.createRepeatLink=()=>{this.createLink("Repeat difficult word","repeat",["nav-item","nav-repeat-word"])},this.createLink=(e,t,s)=>{const i=document.createElement("a");i.innerHTML=e,i.href=`#${t}`,s.forEach((e=>{i.classList.add(e)})),this.element.appendChild(i),this.items.push(i)},this.createBtnLogin=()=>{this.btnLogin=document.createElement("button"),this.btnLogin.innerHTML="Login",this.btnLogin.classList.add("nav-item"),this.btnLogin.classList.add("nav-btn-login"),this.element.appendChild(this.btnLogin),this.btnLogin.addEventListener("click",this.onClickBtnLogin)},this.onClickBtnLogin=()=>{s.onClickBtnLogin()},this.renderLinks()}}class r extends e{constructor(){super("div",["nav-container"]),this.renderBurgerMenuElements=()=>{this.renderNavToggle(),this.renderNavItems()},this.renderNavToggle=()=>{this.navToggle=document.createElement("div"),this.navToggle.classList.add("nav-toggle"),this.element.appendChild(this.navToggle)},this.renderNavItems=async()=>{(async()=>{const e=await fetch("./assets/cards/categories.json"),t=await e.json();return Object.values(t)})().then((e=>{this.navItems=new i(e),this.navItems.render(this.element),this.navItems.element.addEventListener("click",this.onClickNavItems)}))},this.setEventToNavElements=()=>{this.navToggle.addEventListener("click",this.onClickNavToggle),document.addEventListener("mouseup",this.onClickOutNavItems)},this.onClickNavToggle=()=>{const{classList:e}=this.element;e.contains("is-active")?e.remove("is-active"):e.add("is-active")},this.onClickNavItems=e=>{if(e.target.classList.contains("nav-item")){const{classList:e}=this.element;e.remove("is-active")}},this.onClickOutNavItems=e=>{const t=e.target;if(!t.classList.contains("nav-items")&&!t.classList.contains("nav-toggle")){const{classList:e}=this.element;e.remove("is-active")}},this.element.setAttribute("tabindex","0"),this.renderBurgerMenuElements(),this.setEventToNavElements()}}class n extends e{constructor(){super("label",["switch"]),this.renderToogleSwitch=()=>{this.btnToggle=document.createElement("input"),this.btnToggle.type="checkbox",this.btnToggle.checked=!0,this.sliderRound=document.createElement("div"),this.sliderRound.classList.add("slider"),this.element.appendChild(this.btnToggle),this.element.appendChild(this.sliderRound)},this.renderToogleSwitch()}}class a extends e{constructor(t){super("header",["header"]),this.id=t,this.renderHeaderElements=()=>{this.renderHeaderWrapper(),this.renderBurgerMenu(),this.renderBtnToStat(),this.renderToggleSwitch()},this.renderHeaderWrapper=()=>{this.headerWrapper=new e("div",["header__wrapper"]),this.headerWrapper.render(this.element)},this.renderBurgerMenu=()=>{this.burgerMenu=new r,this.burgerMenu.render(this.headerWrapper.element)},this.renderToggleSwitch=()=>{this.toggleSwitch=new n,this.toggleSwitch.render(this.headerWrapper.element)},this.renderBtnToStat=()=>{this.btnToStat=document.createElement("button"),this.btnToStat.classList.add("header__btn-to-stat"),this.btnToStat.innerHTML="Statistics",this.btnToStat.onclick=()=>{window.location.href="#stat"},this.headerWrapper.element.appendChild(this.btnToStat)},this.initHeader=()=>{this.element.id=this.id},this.initHeader(),this.renderHeaderElements()}}class o extends e{constructor(){super("div",["popup-container"]),this.addEventsToElements=()=>{this.btnCancel.addEventListener("click",this.hideForm),this.btnOk.addEventListener("click",this.hideForm)},this.renderLoginFormElements=()=>{this.renderFormPopup(),this.renderHeaderForm(),this.renderInputLogin(),this.renderInputPassword(),this.renderWrapperForBtn(),this.renderBtnCancel(),this.renderBtnOk()},this.renderFormPopup=()=>{this.formPopup=new e("div",["form-popup"]),this.formPopup.render(this.element)},this.renderHeaderForm=()=>{this.headerForm=new e("div",["form-popup__header-form"]),this.headerForm.element.innerHTML="Login",this.headerForm.render(this.formPopup.element)},this.renderInputLogin=()=>{this.inputLogin=document.createElement("input"),this.inputLogin.type="text",this.inputLogin.placeholder="Login",this.inputLogin.name="login",this.inputLogin.pattern="^[\\p{L}']{2,31}$",this.inputLogin.setAttribute("required",""),this.inputLogin.id="login-input",this.inputLogin.className="form-popup__input-text",this.formPopup.element.appendChild(this.inputLogin)},this.renderInputPassword=()=>{this.inputPassword=document.createElement("input"),this.inputPassword.type="text",this.inputPassword.placeholder="Password",this.inputPassword.name="password",this.inputPassword.setAttribute("required",""),this.inputPassword.id="login-password",this.inputPassword.className="form-popup__input-text",this.formPopup.element.appendChild(this.inputPassword)},this.renderWrapperForBtn=()=>{this.wrapperForBtn=new e("div",["form-popup__wrapper-for-btn"]),this.wrapperForBtn.render(this.formPopup.element)},this.renderBtnCancel=()=>{this.btnCancel=document.createElement("button"),this.btnCancel.classList.add("form-popup__btn-cancel"),this.btnCancel.innerHTML="Cancel",this.wrapperForBtn.element.appendChild(this.btnCancel)},this.renderBtnOk=()=>{this.btnOk=document.createElement("button"),this.btnOk.classList.add("form-popup__btn-ok"),this.btnOk.innerHTML="Login",this.wrapperForBtn.element.appendChild(this.btnOk)},this.hideForm=()=>{document.body.classList.remove("notscrollable"),this.element.classList.add("hide")},this.showForm=()=>{document.body.classList.add("notscrollable"),this.element.classList.remove("hide")},this.element.classList.add("hide"),this.renderLoginFormElements(),this.addEventsToElements()}}function d(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var h,c="function"==typeof Symbol&&Symbol.observable||"@@observable",l=function(){return Math.random().toString(36).substring(7).split("").join(".")},p={INIT:"@@redux/INIT"+l(),REPLACE:"@@redux/REPLACE"+l(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+l()}};function m(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function u(e,t,s){var i;if("function"==typeof t&&"function"==typeof s||"function"==typeof s&&"function"==typeof arguments[3])throw new Error(d(0));if("function"==typeof t&&void 0===s&&(s=t,t=void 0),void 0!==s){if("function"!=typeof s)throw new Error(d(1));return s(u)(e,t)}if("function"!=typeof e)throw new Error(d(2));var r=e,n=t,a=[],o=a,h=!1;function l(){o===a&&(o=a.slice())}function g(){if(h)throw new Error(d(3));return n}function C(e){if("function"!=typeof e)throw new Error(d(4));if(h)throw new Error(d(5));var t=!0;return l(),o.push(e),function(){if(t){if(h)throw new Error(d(6));t=!1,l();var s=o.indexOf(e);o.splice(s,1),a=null}}}function w(e){if(!m(e))throw new Error(d(7));if(void 0===e.type)throw new Error(d(8));if(h)throw new Error(d(9));try{h=!0,n=r(n,e)}finally{h=!1}for(var t=a=o,s=0;s<t.length;s++)(0,t[s])();return e}function L(e){if("function"!=typeof e)throw new Error(d(10));r=e,w({type:p.REPLACE})}function k(){var e,t=C;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(d(11));function s(){e.next&&e.next(g())}return s(),{unsubscribe:t(s)}}})[c]=function(){return this},e}return w({type:p.INIT}),(i={dispatch:w,subscribe:C,getState:g,replaceReducer:L})[c]=k,i}!function(e){e.switchPlayMode="switch-play-mode",e.switchTrainMode="switch-train-mode",e.toggleAppMode="toggle-app-mode",e.startGame="start-game",e.stopGame="stop-game",e.setOnClickBtnLogin="set-on-click-btn-login"}(h||(h={}));const g=new class{constructor(){this.initialStore={isPlayMode:!1,isGameStart:!1},this.startGame=()=>{this.store.dispatch({type:h.startGame})},this.stopGame=()=>{this.store.dispatch({type:h.stopGame})},this.switchPlayMode=()=>{this.store.dispatch({type:h.switchPlayMode})},this.switchTrainMode=()=>{this.store.dispatch({type:h.switchTrainMode})},this.toggleAppMode=()=>{this.store.dispatch({type:h.toggleAppMode})},this.isPlayMode=()=>this.store.getState().isPlayMode,this.isGameStart=()=>this.store.getState().isGameStart,this.initStateStore=()=>{this.store.subscribe((()=>console.log(this.store.getState())))},this.stateReducer=(e=this.initialStore,t)=>{switch(t.type){case h.startGame:{const t=e;return t.isGameStart=!0,t}case h.stopGame:{const t=e;return t.isGameStart=!1,t}case h.switchPlayMode:{const t=e;return t.isPlayMode=!0,t}case h.switchTrainMode:{const t=e;return t.isPlayMode=!1,t}case h.toggleAppMode:{const t=e;return t.isPlayMode=!t.isPlayMode,t}default:return e}},this.store=u(this.stateReducer)}},C=async()=>{const e=await fetch("./assets/cards/categories.json"),t=await e.json();return Object.keys(t)},w=async e=>{const t="./assets/cards/category-0"+e+"/category.json",s=await fetch(t);return await s.json()};class L{}L.listWords=[],L.listRepeatWords=[],L.maxRepeatWord=8,L.initStatistics=()=>L.createStructureTable(),L.getListWords=()=>L.listWords,L.getListRepeatWords=()=>{const e=[...L.listWords];return e.sort(((e,t)=>e.mistakes<t.mistakes?1:e.mistakes>t.mistakes?-1:0)),e.length=L.maxRepeatWord,L.listRepeatWords=e.filter((e=>e.mistakes>0)),L.listRepeatWords},L.createStructureTable=async()=>{const e=await C();return Promise.all(e.map((async e=>{const t=await w(e);t.words.forEach((e=>{const s={idCategory:t.idCategory,nameCategory:t.nameCategory,categoryWord:e,clicked:0,mistakes:0,matched:0,percent:0};L.listWords.push(s)}))}))).then((()=>{L.updateListWordsFromLocalStorage()}))},L.resetStatistics=()=>{L.listWords=L.listWords.map((e=>(e.clicked=0,e.matched=0,e.mistakes=0,e.percent=0,e))),L.updateListWordsToLocalStorage()},L.incrementClickedTimesOfWord=(e,t)=>{const s=L.findIndexWord(e,t);s>=0&&(L.listWords[s].clicked+=1),L.updateListWordsToLocalStorage()},L.incrementMistakeTimesOfWord=(e,t)=>{const s=L.findIndexWord(e,t);s>=0&&(L.listWords[s].mistakes+=1),L.updateListWordsToLocalStorage()},L.addMatchedToWord=(e,t)=>{const s=L.findIndexWord(e,t);if(s>=0){L.listWords[s].matched+=1;const e=100;L.listWords[s].percent=Math.round(L.listWords[s].matched/(L.listWords[s].mistakes+L.listWords[s].matched)*e)}L.updateListWordsToLocalStorage()},L.updateListWordsToLocalStorage=()=>{window.localStorage.setItem("listWords",JSON.stringify(L.listWords))},L.updateListWordsFromLocalStorage=()=>{const e=window.localStorage.getItem("listWords")||null;if(e){const t=JSON.parse(e);L.listWords=L.listWords.map((e=>t.find((t=>e.idCategory===t.idCategory&&e.categoryWord.idWord===t.categoryWord.idWord))||e))}},L.findIndexWord=(e,t)=>L.listWords.findIndex((s=>e===s.idCategory&&t===s.categoryWord.idWord));const k=(e,t)=>`${"./assets/cards/category-0"+e+"/pictures"}/${t}.jpg`;class b extends e{constructor(t,s,i){super("div",["card-container"]),this.idCategory=t,this.categoryWord=s,this.idCard=i,this.isFlipped=!1,this.initCard=()=>{this.element.setAttribute("tabindex",this.categoryWord.idWord),this.cardAudio=document.createElement("audio"),this.element.setAttribute("data-id",this.idCard),this.cardAudio.src=((e,t)=>`${"./assets/cards/category-0"+this.idCategory+"/sounds"}/${this.categoryWord.sound}.mp3`)(),this.element.appendChild(this.cardAudio)},this.renderCardElements=()=>{this.renderCard(),this.renderCardFrontView(),this.renderCardBackView()},this.renderCard=()=>{this.card=new e("div",["card"]),this.card.render(this.element)},this.renderCardFrontView=()=>{this.cardFront=new e("div",["card__front"]),this.cardFront.element.appendChild(this.createImage()),this.cardFrontName=new e("div",["card__name"]),this.cardFrontName.element.innerHTML=this.categoryWord.langRU,this.cardFrontName.render(this.cardFront.element),this.cardFront.render(this.card.element)},this.renderCardBackView=()=>{this.cardBack=new e("div",["card__back"]),this.cardBack.element.appendChild(this.createImage()),this.cardBackName=new e("div",["card__name"]),this.cardBackName.element.innerHTML=this.categoryWord.langEN,this.cardBackName.render(this.cardBack.element),this.cardBackBtnFlip=new e("div",["card__btn-flip"]),this.cardBackBtnFlip.render(this.cardBackName.element),this.cardBack.render(this.card.element)},this.createImage=()=>{const e=document.createElement("img");return e.classList.add("card__img"),e.src=k(this.idCategory,this.categoryWord.picture),e.alt=this.categoryWord.picture,e},this.setEventToElements=()=>{this.cardBackBtnFlip.element.addEventListener("click",this.onClickBtnFlip),this.element.addEventListener("mouseleave",this.onMouseLeaveCard)},this.onClickBtnFlip=()=>{this.cardFlip(),this.isFlipped=!this.isFlipped},this.onMouseLeaveCard=()=>{this.isFlipped&&(this.cardFlip(),this.isFlipped=!this.isFlipped)},this.cardFlip=()=>{this.card.element.classList.toggle("card_flipped")},this.initCard(),this.renderCardElements(),this.setEventToElements()}}class v extends e{constructor(e,t){super("div",["smile"]),this.textMessage=e,this.classImage=t,this.renderSmileElements=()=>{this.renderMessageElement(),this.renderSmileElement()},this.renderMessageElement=()=>{this.messageElement=document.createElement("div"),this.messageElement.classList.add("smile__message"),this.messageElement.innerHTML=this.textMessage,this.element.appendChild(this.messageElement)},this.renderSmileElement=()=>{this.imageElement=document.createElement("div"),this.imageElement.classList.add(this.classImage),this.element.appendChild(this.imageElement)},this.setTextMessage=e=>{this.messageElement.innerHTML=e},this.renderSmileElements()}}class E extends v{constructor(e){super(e,"smile__image-lose"),this.textMessage=e}}class f extends v{constructor(e){super(e,"smile__image-win"),this.textMessage=e}}class y extends e{constructor(){super("div",["stars-container"]),this.addStarMistake=()=>{const e=document.createElement("div");e.classList.add("stars-container__star-mistake"),this.element.appendChild(e)},this.addStarMatch=()=>{const e=document.createElement("div");e.classList.add("stars-container__star-match"),this.element.appendChild(e)}}}class T{static win(){this.audio=new Audio("./assets/sounds/win.ogg"),this.audio.play()}static lose(){this.audio=new Audio("./assets/sounds/lose.wav"),this.audio.play()}static mistake(){this.audio=new Audio("./assets/sounds/mistake.wav"),this.audio.play()}static match(){this.audio=new Audio("./assets/sounds/succes.wav"),this.audio.play()}}class W{}W.start=e=>{W.cardsAudio=e,W.currentIndexCard=0,W.mistakes=0,W.indices=W.fillIndeces(),W.playCurrentAudio()},W.checkStatus=e=>W.cardsAudio[W.getCursorIndexCard()]===e?(T.match(),W.currentIndexCard+=1,W.currentIndexCard>=W.cardsAudio.length?W.mistakes>0?(T.lose(),"lose"):(T.win(),"win"):(W.playCurrentAudio(1e3),"match")):(T.mistake(),W.mistakes+=1,"mistake"),W.getCursorIndexCard=()=>W.indices[W.currentIndexCard],W.playCurrentAudio=e=>{let t=500;e&&(t=e),setTimeout((()=>{new Audio(W.cardsAudio[W.getCursorIndexCard()]).play()}),t)},W.fillIndeces=()=>{const e=[];for(let t=0;t<W.cardsAudio.length;t++)e.push(t);return(t=e)&&t.sort((()=>Math.random()-.5)),t;var t},W.getCountMistakes=()=>W.mistakes;class S extends e{constructor(t){super("div",["page-cards"]),this.idCategory=t,this.cards=[],this.words=[],this.cardsAudio=[],this.initPageCards=()=>{this.createSmileLose(),this.createSmileWin()},this.setEventsToElement=()=>{this.btnStart.addEventListener("click",this.onClickBtnStart),this.btnRepeat.addEventListener("click",this.onClickBtnRepeat)},this.onClickCard=e=>{const t=e.currentTarget,s=Number(t.dataset.id);if(g.isPlayMode()||(this.cards[s].cardAudio.play(),L.incrementClickedTimesOfWord(this.cards[s].idCategory,this.cards[s].categoryWord.idWord)),g.isGameStart()){const e=W.checkStatus(this.cardsAudio[s]);"mistake"!==e&&this.isStatusCardNotMistake(s,t),"mistake"===e&&this.isStatusCardMistake(),"win"===e&&this.isStatusCardWin(),"lose"===e&&this.isStatusCardLose()}},this.isStatusCardNotMistake=(e,t)=>{this.cards[e].element.removeEventListener("click",this.onClickCard),t.classList.add("matched"),this.starsContainer.addStarMatch(),L.addMatchedToWord(this.cards[e].idCategory,this.cards[e].categoryWord.idWord)},this.isStatusCardMistake=()=>{this.starsContainer.addStarMistake(),L.incrementMistakeTimesOfWord(this.cards[W.getCursorIndexCard()].idCategory,this.cards[W.getCursorIndexCard()].categoryWord.idWord)},this.isStatusCardWin=()=>{g.stopGame(),this.wrapperForCards.element.innerHTML="",this.wrapperForCards.element.appendChild(this.smileWin.element),this.redirectToPageCategory()},this.isStatusCardLose=()=>{g.stopGame(),this.wrapperForCards.element.innerHTML="",this.smileLose.setTextMessage(`You made ${W.getCountMistakes()} mistakes`),this.wrapperForCards.element.appendChild(this.smileLose.element),this.redirectToPageCategory()},this.onClickBtnStart=()=>{g.startGame(),this.btnStart.classList.remove("show"),this.btnRepeat.classList.add("show"),W.start(this.cardsAudio)},this.onClickBtnRepeat=()=>{W.playCurrentAudio(100)},this.renderPageCardsElements=()=>{this.renderWrapperForStars(),this.renderStarsContainer(),this.renderWrapperForCards(),this.renderPageCards(),this.renderWrapperForBtn(),this.renderBtnStart(),this.renderBtnRepeat()},this.renderWrapperForStars=()=>{this.wrapperForStars=new e("div",["page-cards__wrapper-for-stars"]),this.wrapperForStars.render(this.element)},this.renderStarsContainer=()=>{this.starsContainer=new y,this.starsContainer.render(this.wrapperForStars.element)},this.renderWrapperForCards=()=>{this.wrapperForCards=new e("div",["page-cards__wrapper-for-cards"]),this.wrapperForCards.render(this.element)},this.renderPageCards=()=>{if(this.cardsAudio=[],this.cards=[],"repeat"!==this.idCategory)w(this.idCategory).then((e=>{this.words=e.words,e.words.forEach(((t,s)=>{const i=new b(e.idCategory,t,String(s));i.render(this.wrapperForCards.element),i.element.addEventListener("click",this.onClickCard),this.cardsAudio.push(i.cardAudio.src),this.cards.push(i)}))}));else{const e=L.getListRepeatWords();this.words=[],e.forEach(((e,t)=>{this.words.push(e.categoryWord);const s=new b(e.idCategory,e.categoryWord,String(t));s.render(this.wrapperForCards.element),s.element.addEventListener("click",this.onClickCard),this.cardsAudio.push(s.cardAudio.src),this.cards.push(s)}))}},this.renderWrapperForBtn=()=>{this.wrapperForBtn=new e("div",["page-cards__wrapper-for-btn"]),this.wrapperForBtn.render(this.element)},this.renderBtnStart=()=>{this.btnStart=document.createElement("button"),this.btnStart.classList.add("btn"),this.btnStart.classList.add("show"),this.btnStart.innerHTML="Start",this.wrapperForBtn.element.appendChild(this.btnStart)},this.renderBtnRepeat=()=>{this.btnRepeat=document.createElement("button"),this.btnRepeat.classList.add("btn"),this.btnRepeat.classList.add("btn-repeat"),this.wrapperForBtn.element.appendChild(this.btnRepeat)},this.createSmileLose=()=>{this.smileLose=new E("You LOSE :(")},this.createSmileWin=()=>{this.smileWin=new f("You WIN !!!")},this.redirectToPageCategory=()=>{this.btnRepeat.classList.remove("show"),setTimeout((()=>{window.location.href="#categories"}),4e3)},this.renderPageCardsElements(),this.initPageCards(),this.setEventsToElement()}}class M extends e{constructor(t,s){super("a",["page-categories__category"]),this.idCategory=t,this.nameImg=s,this.renderElements=()=>{w(this.idCategory).then((t=>{this.element.setAttribute("href",`#${this.idCategory}`),this.imgCategory=new e("img",["page-categories__category-img"]),this.imgCategory.element.setAttribute("src",k(this.idCategory,t.words[0].picture)),this.imgCategory.element.setAttribute("alt",t.words[0].picture),this.imgCategory.render(this.element),this.element.innerHTML+=t.nameCategory}))},this.renderElements()}}class P extends e{constructor(){super("div",["page-categories"]),this.categories=[],this.setEventsToElement=()=>{},this.renderPageCategoriesElements=()=>{this.renderWrapperForCategories(),this.renderCategories()},this.renderWrapperForCategories=()=>{this.wrapperForCategories=new e("div",["page-categories__wrapper-for-categories"]),this.wrapperForCategories.render(this.element)},this.renderCategories=()=>{C().then((e=>{e.forEach((e=>{const t=new M(e,"");t.render(this.wrapperForCategories.element),this.categories.push(t)}))}))},this.renderPageCategoriesElements(),this.setEventsToElement()}}class F extends e{constructor(t){super("div",["dialog-popup"]),this.okClickCallback=t,this.addEventsToDialogPopupElements=()=>{this.btnOk.element.addEventListener("click",this.onClickBtnOk),this.btnCancel.element.addEventListener("click",this.onClickBtnCancel)},this.initDialogPopup=()=>{this.render(document.body),this.hide()},this.renderDialogPopupElements=()=>{this.renderPopup(),this.renderPopupHeader(),this.renderPopupText(),this.renderBtns()},this.renderPopup=()=>{this.popup=new e("div",["popup"]),this.popup.render(this.element)},this.renderPopupHeader=()=>{this.popupHeader=new e("div",["popup-header"]),this.popupHeader.element.innerHTML="WARNING!",this.popupHeader.render(this.popup.element)},this.renderPopupText=()=>{this.popupText=new e("div",["popup-text"]),this.popupText.render(this.popup.element)},this.renderBtns=()=>{this.wrapperForBtn=new e("div",["wrapper-for-btn"]),this.wrapperForBtn.render(this.popup.element),this.btnOk=new e("button",["btn-ok"]),this.btnOk.element.innerHTML="ok",this.btnOk.render(this.wrapperForBtn.element),this.btnCancel=new e("button",["btn-cancel"]),this.btnCancel.element.innerHTML="cancel",this.btnCancel.render(this.wrapperForBtn.element)},this.onClickBtnOk=()=>{this.hide(),this.okClickCallback&&this.okClickCallback()},this.onClickBtnCancel=()=>{this.hide()},this.initDialogPopup(),this.renderDialogPopupElements(),this.addEventsToDialogPopupElements()}hide(){document.body.classList.remove("notscrollable"),this.element.classList.add("hide")}show(e){this.popupText.element.innerHTML=e,document.body.classList.add("notscrollable"),this.element.classList.remove("hide")}}const B=["num","category","word","translate","clicked","mathed","mistakes","percent"];class H extends e{constructor(e){super("table",["page-stat__stat-table"]),this.listWord=e,this.listCellsHeader=B,this.renderStatTableElements=()=>{this.element.innerHTML="",this.renderHeaderCells(),this.renderTableCells()},this.renderHeaderCells=()=>{if(!this.rowHeader){const e=this.element.createTHead();this.rowHeader=e.insertRow(0),this.listCellsHeader.forEach((e=>{const t=this.rowHeader.insertCell();t.id=e,t.innerHTML=e,this.rowHeader.append(t)}))}},this.renderTableCells=()=>{const e=this.element;this.rowHeader&&e.createTHead().append(this.rowHeader),this.listWord.forEach(((t,s)=>{const i=e.insertRow();i.insertCell().innerHTML=String(s+1),i.insertCell().innerHTML=t.nameCategory,i.insertCell().innerHTML=t.categoryWord.langEN,i.insertCell().innerHTML=t.categoryWord.langRU,i.insertCell().innerHTML=String(t.clicked),i.insertCell().innerHTML=String(t.matched),i.insertCell().innerHTML=String(t.mistakes),i.insertCell().innerHTML=String(t.percent),e.appendChild(i)}))},this.onClickRowHeader=e=>{const t=e.target;t&&(this.rowHeader.querySelectorAll("td").forEach((e=>{e.id!==t.id&&(e.classList.remove("up-sort"),e.classList.remove("down-sort"))})),this.compareIdElement=t.id,"num"!==t.id&&this.clickRowCellHeader(t))},this.clickRowCellHeader=e=>{const t=e,s=[...this.listWord];t.classList.contains("down-sort")?(this.listWord.sort(this.byAscending),this.renderStatTableElements(),t.classList.remove("down-sort"),t.classList.add("up-sort")):t.classList.contains("up-sort")?(this.renderStatTableElements(),t.classList.remove("up-sort")):(this.listWord.sort(this.byDescending),this.renderStatTableElements(),t.classList.add("down-sort")),this.listWord=[...s]},this.byAscending=(e,t)=>{const s=this.switchComareElement(e,t);return s.a>s.b?1:s.a<s.b?-1:0},this.byDescending=(e,t)=>{const s=this.switchComareElement(e,t);return s.a<s.b?1:s.a>s.b?-1:0},this.switchComareElement=(e,t)=>{let s,i;switch(this.compareIdElement){case"category":s=e.nameCategory,i=t.nameCategory;break;case"word":s=e.categoryWord.langEN,i=t.categoryWord.langEN;break;case"translate":s=e.categoryWord.langRU,i=t.categoryWord.langRU;break;case"clicked":s=e.clicked,i=t.clicked;break;case"mathed":s=e.matched,i=t.matched;break;case"mistakes":s=e.mistakes,i=t.mistakes;break;case"percent":s=e.percent,i=t.percent;break;default:s=e.nameCategory,i=t.nameCategory}return{a:s,b:i}},this.renderStatTableElements(),this.rowHeader.addEventListener("click",this.onClickRowHeader)}}class _ extends e{constructor(){super("div",["page-stat"]),this.addEventsToPageStatElements=()=>{this.btnRepeatWord.addEventListener("click",this.onClickBtnRepeatWord),this.btnReset.addEventListener("click",this.onClickBtnReset)},this.onClickBtnRepeatWord=()=>{window.location.href="#repeat"},this.onClickBtnReset=()=>{this.dialogPopup.show("\n    Are you sure? <br/>\n    All statistics data will be deleted!")},this.renderPageStatElements=()=>{this.renderBtnRepeatWord(),this.renderBtnReset(),this.renderStatTable()},this.renderStatTable=()=>{this.statTable=new H(L.getListWords()),this.statTable.render(this.element)},this.renderBtnRepeatWord=()=>{this.btnRepeatWord=document.createElement("button"),this.btnRepeatWord.classList.add("page-stat__btn"),this.btnRepeatWord.innerHTML="Repeat difficult word",this.element.append(this.btnRepeatWord)},this.renderBtnReset=()=>{this.btnReset=document.createElement("button"),this.btnReset.classList.add("page-stat__btn"),this.btnReset.classList.add("btn-reset"),this.btnReset.innerHTML="Reset statistics",this.element.append(this.btnReset)},this.createDialogPopup=()=>{this.dialogPopup=new F(this.resetSatistics)},this.resetSatistics=()=>{L.resetStatistics(),this.statTable.renderStatTableElements()},this.renderPageStatElements(),this.addEventsToPageStatElements(),this.createDialogPopup()}}const A=window.location.hash.slice(1),R=new class{constructor(e){this.container=document.body,this.setEventToElements=()=>{this.header.toggleSwitch.element.addEventListener("change",this.onChangeToggleSwitch)},this.onChangeToggleSwitch=()=>{this.container.classList.toggle("play"),g.toggleAppMode(),g.stopGame()},this.createAppElements=()=>{this.createHeader(),this.createMain(),this.createMainWrapper(),this.createLoginForm(),this.createFooter()},this.createHeader=()=>{this.header=new a("header")},this.createFooter=()=>{this.footer=new t("footer")},this.createMain=()=>{this.main=document.createElement("main")},this.createMainWrapper=()=>{this.mainWrapper=document.createElement("div"),this.mainWrapper.classList.add("main__wrapper")},this.createPageCategories=()=>{this.setActiveLinkToPageCategories(),this.pageCategories=new P},this.createPageCards=()=>{this.setActiveLinkToPageCards(),this.idPage?this.pageCards=new S(this.idPage):this.pageCards=new S("1")},this.createPageStat=()=>{this.setActiveLinkToPageStatistics(),this.pageStat=new _},this.createLoginForm=()=>{this.loginForm=new o},this.renderMainPage=()=>{"stat"===this.idPage&&(this.mainWrapper.innerHTML="",this.createPageStat(),this.pageStat.render(this.mainWrapper)),"categories"!==this.idPage&&this.idPage||(this.mainWrapper.innerHTML="",this.createPageCategories(),this.pageCategories.render(this.mainWrapper)),"stat"!==this.idPage&&"categories"!==this.idPage&&(this.mainWrapper.innerHTML="",this.createPageCards(),this.pageCards.render(this.mainWrapper))},this.enableRouteChange=()=>{window.addEventListener("hashchange",this.onChangeHash)},this.onChangeHash=()=>{g.stopGame(),this.idPage=window.location.hash.slice(1),this.mainWrapper.innerHTML="",this.renderMainPage()},this.setActiveLinkToPageCards=()=>{if("repeat"!==this.idPage&&this.setActiveLink(Number(this.idPage)),"repeat"===this.idPage){const e=this.header.burgerMenu.navItems.items.length-1;this.setActiveLink(e)}},this.setActiveLinkToPageCategories=()=>{this.setActiveLink(0)},this.setActiveLinkToPageStatistics=()=>{this.setActiveLink()},this.onClickBtnLogin=()=>{this.loginForm.showForm()},this.idPage=e,this.createAppElements(),this.setEventToElements()}run(){g.initStateStore(),L.initStatistics().finally((()=>{this.container.append(this.header.element),this.enableRouteChange(),this.container.append(this.main),this.main.appendChild(this.mainWrapper),this.renderMainPage(),this.container.append(this.loginForm.element),this.container.append(this.footer.element),s.onClickBtnLogin=this.onClickBtnLogin}))}setActiveLink(e){this.header.burgerMenu.navItems.items.forEach((e=>{e.classList.remove("active")})),(e||0===e)&&this.header.burgerMenu.navItems.items[e].classList.add("active")}}(A);window.onload=()=>{R.run()}})();