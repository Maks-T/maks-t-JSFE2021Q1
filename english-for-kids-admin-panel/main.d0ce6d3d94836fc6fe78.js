(()=>{"use strict";function e(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var t,r="function"==typeof Symbol&&Symbol.observable||"@@observable",i=function(){return Math.random().toString(36).substring(7).split("").join(".")},s={INIT:"@@redux/INIT"+i(),REPLACE:"@@redux/REPLACE"+i(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+i()}};function n(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function a(t,i,d){var o;if("function"==typeof i&&"function"==typeof d||"function"==typeof d&&"function"==typeof arguments[3])throw new Error(e(0));if("function"==typeof i&&void 0===d&&(d=i,i=void 0),void 0!==d){if("function"!=typeof d)throw new Error(e(1));return d(a)(t,i)}if("function"!=typeof t)throw new Error(e(2));var h=t,l=i,c=[],m=c,p=!1;function u(){m===c&&(m=c.slice())}function g(){if(p)throw new Error(e(3));return l}function C(t){if("function"!=typeof t)throw new Error(e(4));if(p)throw new Error(e(5));var r=!0;return u(),m.push(t),function(){if(r){if(p)throw new Error(e(6));r=!1,u();var i=m.indexOf(t);m.splice(i,1),c=null}}}function w(t){if(!n(t))throw new Error(e(7));if(void 0===t.type)throw new Error(e(8));if(p)throw new Error(e(9));try{p=!0,l=h(l,t)}finally{p=!1}for(var r=c=m,i=0;i<r.length;i++)(0,r[i])();return t}function L(t){if("function"!=typeof t)throw new Error(e(10));h=t,w({type:s.REPLACE})}function b(){var t,i=C;return(t={subscribe:function(t){if("object"!=typeof t||null===t)throw new Error(e(11));function r(){t.next&&t.next(g())}return r(),{unsubscribe:i(r)}}})[r]=function(){return this},t}return w({type:s.INIT}),(o={dispatch:w,subscribe:C,getState:g,replaceReducer:L})[r]=b,o}!function(e){e.switchPlayMode="switch-play-mode",e.switchTrainMode="switch-train-mode",e.toggleAppMode="toggle-app-mode",e.startGame="start-game",e.stopGame="stop-game",e.setOnClickBtnLogin="set-on-click-btn-login",e.setLoginTrue="set-login-true",e.setLoginFalse="set-login-false"}(t||(t={}));const d=new class{constructor(){this.initialStore={isPlayMode:!1,isGameStart:!1,isLogin:!1},this.startGame=()=>{this.store.dispatch({type:t.startGame})},this.stopGame=()=>{this.store.dispatch({type:t.stopGame})},this.switchPlayMode=()=>{this.store.dispatch({type:t.switchPlayMode})},this.switchTrainMode=()=>{this.store.dispatch({type:t.switchTrainMode})},this.toggleAppMode=()=>{this.store.dispatch({type:t.toggleAppMode})},this.isPlayMode=()=>this.store.getState().isPlayMode,this.isGameStart=()=>this.store.getState().isGameStart,this.setLoginTrue=()=>{this.store.dispatch({type:t.setLoginTrue})},this.setLoginFalse=()=>{this.store.dispatch({type:t.setLoginFalse})},this.isLogin=()=>this.store.getState().isLogin,this.initStateStore=()=>{this.store.subscribe((()=>console.log(this.store.getState())))},this.stateReducer=(e=this.initialStore,r)=>{switch(r.type){case t.startGame:{const t=e;return t.isGameStart=!0,t}case t.stopGame:{const t=e;return t.isGameStart=!1,t}case t.switchPlayMode:{const t=e;return t.isPlayMode=!0,t}case t.switchTrainMode:{const t=e;return t.isPlayMode=!1,t}case t.toggleAppMode:{const t=e;return t.isPlayMode=!t.isPlayMode,t}case t.setLoginTrue:{const t=e;return t.isLogin=!0,t}case t.setLoginFalse:{const t=e;return t.isLogin=!1,t}default:return e}},this.store=a(this.stateReducer)}};class o{constructor(e="div",t=[]){this.element=document.createElement(e),this.element.classList.add(...t)}render(e){e.appendChild(this.element)}}class h extends o{constructor(){super("header",["header-admin"]),this.setEventsToHEaderElements=()=>{this.linkLogOut.element.addEventListener("click",this.onCLickLinlLogOut)},this.onCLickLinlLogOut=()=>{window.localStorage.removeItem("loginData"),d.setLoginFalse()},this.renderHeaderWrapper=()=>{this.headerWrapper=new o("div",["header-admin__wrapper"]),this.headerWrapper.render(this.element),this.renderLeftWrapper(),this.renderRightWrapper()},this.renderLeftWrapper=()=>{this.leftWrapper=new o("div",["header-admin__wrapper-left"]),this.leftWrapper.render(this.headerWrapper.element),this.renderLinkCategories(),this.renderLinkWords()},this.renderLinkCategories=()=>{this.linkCategories=new o("a",["header-admin__link-categories"]),this.linkCategories.element.setAttribute("href","#admin-categories"),this.linkCategories.element.innerHTML="Categories",this.linkCategories.render(this.leftWrapper.element)},this.renderLinkWords=()=>{this.linkWords=new o("a",["header-admin__link-words"]),this.linkWords.element.innerHTML="Words",this.linkWords.render(this.leftWrapper.element)},this.renderRightWrapper=()=>{this.rightWrapper=new o("div",["header-admin__wrapper-right"]),this.rightWrapper.render(this.headerWrapper.element),this.renderLinkMainPage(),this.renderLinkLogOut()},this.renderLinkMainPage=()=>{this.linkMainPage=new o("a",["header-admin__link-main-page"]),this.linkMainPage.element.setAttribute("href",""),this.linkMainPage.element.innerHTML="Main Page",this.linkMainPage.render(this.rightWrapper.element)},this.renderLinkLogOut=()=>{this.linkLogOut=new o("a",["header-admin__link-log-out"]),this.linkLogOut.element.setAttribute("href",""),this.linkLogOut.element.innerHTML="LogOut",this.linkLogOut.render(this.rightWrapper.element)},this.renderHeaderWrapper(),this.setEventsToHEaderElements()}}class l extends o{constructor(e){super("footer",["footer"]),this.id=e,this.renderFooterElements=()=>{this.renderFooterWrapper(),this.renderFooterLinks()},this.renderFooterWrapper=()=>{this.footerWrapper=new o("div",["footer__wrapper"]),this.footerWrapper.render(this.element)},this.renderFooterLinks=()=>{this.githubLink=document.createElement("a"),this.githubLink.classList.add("footer__link-github"),this.githubLink.innerHTML="Maxim Tsatsura",this.githubLink.href="https://github.com/Maks-T",this.githubLink.setAttribute("target","_blank"),this.githubLink.setAttribute("rel","noopener noreferrer"),this.footerWrapper.element.appendChild(this.githubLink),this.rssLink=document.createElement("a"),this.rssLink.classList.add("footer__link-rss"),this.rssLink.innerHTML="21",this.rssLink.href="https://rs.school/js/",this.rssLink.setAttribute("target","_blank"),this.rssLink.setAttribute("rel","noopener noreferrer"),this.footerWrapper.element.appendChild(this.rssLink)},this.initFooter=()=>{this.element.id=this.id},this.initFooter(),this.renderFooterElements()}}const c=async()=>{const e=await fetch("https://www.maks-t.com/api/getcategories");return await e.json()};class m{}var p;m.onClickBtnLogin=()=>{},m.routerAdminWords=()=>{},function(e){e.LOGIN_SUCCES="LOGIN SUCCES",e.LOGIN_ERROR="LOGIN ERROR",e.LOGIN_SUCCES_DELETE="LOGIN SUCCES DELETE",e.LOGIN_ERROR_DELETE="LOGIN ERROR DELETE",e.CATEGORY_SUCCES_CREATED="CATEGORY SUCCES CREATED",e.CATEGORY_ERROR_ALREADY_CREATED="CATEGORY ERROR ALREADY CREATED"}(p||(p={}));const u=async()=>{const e=window.localStorage.getItem("loginData")||null;if(e){const t=JSON.parse(e);if((await(async e=>{const t=await fetch("https://www.maks-t.com/api/checklogin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()})(t)).message===p.LOGIN_SUCCES)return!0}return!1};class g extends o{constructor(e){super("div",["nav-items"]),this.categories=e,this.items=[],this.renderLinks=()=>{this.createMainLink(),this.createLinks(),this.createRepeatLink(),this.createBtnLogin()},this.createMainLink=()=>{this.createLink("Main Page","categories",["nav-item","active"])},this.createLinks=()=>{this.categories.forEach((e=>{this.createLink(e.nameCategory,e.nameRouter,["nav-item"])}))},this.createRepeatLink=()=>{this.createLink("Repeat difficult word","repeat",["nav-item","nav-repeat-word"])},this.createLink=(e,t,r)=>{const i=document.createElement("a");i.innerHTML=e,i.href=`#${t}`,r.forEach((e=>{i.classList.add(e)})),this.element.appendChild(i),this.items.push(i)},this.createBtnLogin=()=>{this.btnLogin=document.createElement("button"),this.btnLogin.innerHTML="Login",this.btnLogin.classList.add("nav-item"),this.btnLogin.classList.add("nav-btn-login"),this.element.appendChild(this.btnLogin),this.btnLogin.addEventListener("click",this.onClickBtnLogin),u().then((e=>{e&&(this.btnLogin.innerHTML="LogOut")}))},this.onClickBtnLogin=()=>{m.onClickBtnLogin()},this.renderLinks()}}class C extends o{constructor(){super("div",["nav-container"]),this.renderBurgerMenuElements=()=>{this.renderNavToggle(),this.renderNavItems()},this.renderNavToggle=()=>{this.navToggle=document.createElement("div"),this.navToggle.classList.add("nav-toggle"),this.element.appendChild(this.navToggle)},this.renderNavItems=async()=>{c().then((e=>{this.navItems=new g(e),this.navItems.render(this.element),this.navItems.element.addEventListener("click",this.onClickNavItems)}))},this.setEventToNavElements=()=>{this.navToggle.addEventListener("click",this.onClickNavToggle),document.addEventListener("mouseup",this.onClickOutNavItems)},this.onClickNavToggle=()=>{const{classList:e}=this.element;e.contains("is-active")?e.remove("is-active"):e.add("is-active")},this.onClickNavItems=e=>{if(e.target.classList.contains("nav-item")){const{classList:e}=this.element;e.remove("is-active")}},this.onClickOutNavItems=e=>{const t=e.target;if(!t.classList.contains("nav-items")&&!t.classList.contains("nav-toggle")){const{classList:e}=this.element;e.remove("is-active")}},this.element.setAttribute("tabindex","0"),this.renderBurgerMenuElements(),this.setEventToNavElements()}}class w extends o{constructor(){super("label",["switch"]),this.renderToogleSwitch=()=>{this.btnToggle=document.createElement("input"),this.btnToggle.type="checkbox",this.btnToggle.checked=!0,this.sliderRound=document.createElement("div"),this.sliderRound.classList.add("slider"),this.element.appendChild(this.btnToggle),this.element.appendChild(this.sliderRound)},this.renderToogleSwitch()}}class L extends o{constructor(e){super("header",["header"]),this.id=e,this.renderHeaderElements=()=>{this.renderHeaderWrapper(),this.renderBurgerMenu(),this.renderBtnToStat(),this.renderWrapperLoginBtns(),this.renderToggleSwitch()},this.renderHeaderWrapper=()=>{this.headerWrapper=new o("div",["header__wrapper"]),this.headerWrapper.render(this.element)},this.renderBurgerMenu=()=>{this.burgerMenu=new C,this.burgerMenu.render(this.headerWrapper.element)},this.renderToggleSwitch=()=>{this.toggleSwitch=new w,this.toggleSwitch.render(this.headerWrapper.element)},this.renderBtnToStat=()=>{this.btnToStat=document.createElement("button"),this.btnToStat.classList.add("header__btn-to-stat"),this.btnToStat.innerHTML="Statistics",this.btnToStat.onclick=()=>{window.location.href="#stat"},this.headerWrapper.element.appendChild(this.btnToStat)},this.renderWrapperLoginBtns=()=>{this.wrapperLoginBtns=new o("div",["header__wrapper-login-btns"]),this.wrapperLoginBtns.render(this.headerWrapper.element),this.renderBtnAdminPanel(),this.renderBtnLogOut()},this.renderBtnAdminPanel=()=>{this.btnAdminPanel=new o("a",["header__btn-to-admin-panel","hide"]),this.btnAdminPanel.element.innerHTML="Admin Panel",this.btnAdminPanel.element.setAttribute("href","#admin-categories"),this.btnAdminPanel.render(this.wrapperLoginBtns.element)},this.renderBtnLogOut=()=>{this.btnLogOut=new o("button",["header__btn-to-logout","hide"]),this.btnLogOut.element.innerHTML="LogOut",this.btnLogOut.render(this.wrapperLoginBtns.element)},this.initHeader=()=>{this.element.id=this.id},this.initHeader(),this.renderHeaderElements()}}class b extends o{constructor(){super("div",["popup-container"]),this.renderLoginFormElements=()=>{this.renderFormPopup(),this.renderHeaderForm(),this.renderMessageForm(),this.renderInputLogin(),this.renderInputPassword(),this.renderWrapperForBtn(),this.renderBtnCancel(),this.renderBtnOk()},this.renderFormPopup=()=>{this.formPopup=new o("form",["form-popup"]),this.formPopup.render(this.element)},this.renderHeaderForm=()=>{this.headerForm=new o("div",["form-popup__header-form"]),this.headerForm.element.innerHTML="Login",this.headerForm.render(this.formPopup.element)},this.renderMessageForm=()=>{this.messageForm=new o("div",["form-popup__message-form"]),this.messageForm.render(this.formPopup.element)},this.renderInputLogin=()=>{this.inputLogin=document.createElement("input"),this.inputLogin.type="text",this.inputLogin.placeholder="Login",this.inputLogin.name="login",this.inputLogin.pattern="^[\\p{L}']{2,31}$",this.inputLogin.setAttribute("required",""),this.inputLogin.id="login-input",this.inputLogin.className="form-popup__input-text",this.formPopup.element.appendChild(this.inputLogin)},this.renderInputPassword=()=>{this.inputPassword=document.createElement("input"),this.inputPassword.type="password",this.inputPassword.placeholder="Password",this.inputPassword.name="password",this.inputPassword.setAttribute("required",""),this.inputPassword.id="login-password",this.inputPassword.className="form-popup__input-text",this.formPopup.element.appendChild(this.inputPassword)},this.renderWrapperForBtn=()=>{this.wrapperForBtn=new o("div",["form-popup__wrapper-for-btn"]),this.wrapperForBtn.render(this.formPopup.element)},this.renderBtnCancel=()=>{this.btnCancel=document.createElement("input"),this.btnCancel.type="button",this.btnCancel.classList.add("form-popup__btn-cancel"),this.btnCancel.value="Cancel",this.btnCancel.addEventListener("click",this.hideForm),this.wrapperForBtn.element.appendChild(this.btnCancel)},this.renderBtnOk=()=>{this.btnOk=document.createElement("input"),this.btnOk.type="submit",this.btnOk.classList.add("form-popup__btn-ok"),this.btnOk.value="Login",this.wrapperForBtn.element.appendChild(this.btnOk)},this.hideForm=()=>{document.body.classList.remove("notscrollable"),this.element.classList.add("hide")},this.showForm=()=>{document.body.classList.add("notscrollable"),this.element.classList.remove("hide")},this.element.classList.add("hide"),this.renderLoginFormElements()}}class v{}v.mapRouter=new Map,v.registerRouter=(e,t)=>{v.mapRouter.set(e,t)},v.callRouter=e=>{v.mapRouter.get(e)()};class E{}E.listWords=[],E.listRepeatWords=[],E.maxRepeatWord=8,E.initStatistics=()=>E.createStructureTable(),E.getListWords=()=>E.listWords,E.getListRepeatWords=()=>{const e=[...E.listWords];return e.sort(((e,t)=>e.mistakes<t.mistakes?1:e.mistakes>t.mistakes?-1:0)),e.length=E.maxRepeatWord,E.listRepeatWords=e.filter((e=>e.mistakes>0)),E.listRepeatWords},E.createStructureTable=async()=>{(await c()).forEach((e=>{e.words.forEach((t=>{const r={nameRouter:e.nameRouter,nameCategory:e.nameCategory,categoryWord:t,clicked:0,mistakes:0,matched:0,percent:0};E.listWords.push(r)}))})),E.updateListWordsFromLocalStorage()},E.resetStatistics=()=>{E.listWords=E.listWords.map((e=>(e.clicked=0,e.matched=0,e.mistakes=0,e.percent=0,e))),E.updateListWordsToLocalStorage()},E.incrementClickedTimesOfWord=(e,t)=>{const r=E.findIndexWord(e,t);r>=0&&(E.listWords[r].clicked+=1),E.updateListWordsToLocalStorage()},E.incrementMistakeTimesOfWord=(e,t)=>{const r=E.findIndexWord(e,t);r>=0&&(E.listWords[r].mistakes+=1),E.updateListWordsToLocalStorage()},E.addMatchedToWord=(e,t)=>{const r=E.findIndexWord(e,t);if(r>=0){E.listWords[r].matched+=1;const e=100;E.listWords[r].percent=Math.round(E.listWords[r].matched/(E.listWords[r].mistakes+E.listWords[r].matched)*e)}E.updateListWordsToLocalStorage()},E.updateListWordsToLocalStorage=()=>{window.localStorage.setItem("listWords",JSON.stringify(E.listWords))},E.updateListWordsFromLocalStorage=()=>{const e=window.localStorage.getItem("listWords")||null;if(e){const t=JSON.parse(e);E.listWords=E.listWords.map((e=>t.find((t=>e.nameRouter===t.nameRouter&&e.categoryWord.idWord===t.categoryWord.idWord))||e))}},E.findIndexWord=(e,t)=>E.listWords.findIndex((r=>e===r.nameRouter&&t===r.categoryWord.idWord));class W extends o{constructor(e,t,r){super("div",["card-container"]),this.nameRouter=e,this.categoryWord=t,this.idCard=r,this.isFlipped=!1,this.initCard=()=>{this.element.setAttribute("tabindex",this.categoryWord.idWord),this.cardAudio=document.createElement("audio"),this.element.setAttribute("data-id",this.idCard),this.cardAudio.src="https://www.maks-t.com/"+this.categoryWord.sound,this.element.appendChild(this.cardAudio)},this.renderCardElements=()=>{this.renderCard(),this.renderCardFrontView(),this.renderCardBackView()},this.renderCard=()=>{this.card=new o("div",["card"]),this.card.render(this.element)},this.renderCardFrontView=()=>{this.cardFront=new o("div",["card__front"]),this.cardFront.element.appendChild(this.createImage()),this.cardFrontName=new o("div",["card__name"]),this.cardFrontName.element.innerHTML=this.categoryWord.langRU,this.cardFrontName.render(this.cardFront.element),this.cardFront.render(this.card.element)},this.renderCardBackView=()=>{this.cardBack=new o("div",["card__back"]),this.cardBack.element.appendChild(this.createImage()),this.cardBackName=new o("div",["card__name"]),this.cardBackName.element.innerHTML=this.categoryWord.langEN,this.cardBackName.render(this.cardBack.element),this.cardBackBtnFlip=new o("div",["card__btn-flip"]),this.cardBackBtnFlip.render(this.cardBackName.element),this.cardBack.render(this.card.element)},this.createImage=()=>{const e=document.createElement("img");return e.classList.add("card__img"),e.src="https://www.maks-t.com/"+this.categoryWord.picture,e.alt=this.categoryWord.langEN,e},this.setEventToElements=()=>{this.cardBackBtnFlip.element.addEventListener("click",this.onClickBtnFlip),this.element.addEventListener("mouseleave",this.onMouseLeaveCard)},this.onClickBtnFlip=()=>{this.cardFlip(),this.isFlipped=!this.isFlipped},this.onMouseLeaveCard=()=>{this.isFlipped&&(this.cardFlip(),this.isFlipped=!this.isFlipped)},this.cardFlip=()=>{this.card.element.classList.toggle("card_flipped")},this.initCard(),this.renderCardElements(),this.setEventToElements()}}class k extends o{constructor(e,t){super("div",["smile"]),this.textMessage=e,this.classImage=t,this.renderSmileElements=()=>{this.renderMessageElement(),this.renderSmileElement()},this.renderMessageElement=()=>{this.messageElement=document.createElement("div"),this.messageElement.classList.add("smile__message"),this.messageElement.innerHTML=this.textMessage,this.element.appendChild(this.messageElement)},this.renderSmileElement=()=>{this.imageElement=document.createElement("div"),this.imageElement.classList.add(this.classImage),this.element.appendChild(this.imageElement)},this.setTextMessage=e=>{this.messageElement.innerHTML=e},this.renderSmileElements()}}class y extends k{constructor(e){super(e,"smile__image-lose"),this.textMessage=e}}class f extends k{constructor(e){super(e,"smile__image-win"),this.textMessage=e}}class S extends o{constructor(){super("div",["stars-container"]),this.addStarMistake=()=>{const e=document.createElement("div");e.classList.add("stars-container__star-mistake"),this.element.appendChild(e)},this.addStarMatch=()=>{const e=document.createElement("div");e.classList.add("stars-container__star-match"),this.element.appendChild(e)}}}const T=async e=>{const t=await fetch(`https://www.maks-t.com/api/getcategorybyrouter/${e}`);return await t.json()};class _{static win(){this.audio=new Audio("./assets/sounds/win.ogg"),this.audio.play()}static lose(){this.audio=new Audio("./assets/sounds/lose.wav"),this.audio.play()}static mistake(){this.audio=new Audio("./assets/sounds/mistake.wav"),this.audio.play()}static match(){this.audio=new Audio("./assets/sounds/succes.wav"),this.audio.play()}}class M{}M.start=e=>{M.cardsAudio=e,M.currentIndexCard=0,M.mistakes=0,M.indices=M.fillIndeces(),M.playCurrentAudio()},M.checkStatus=e=>M.cardsAudio[M.getCursorIndexCard()]===e?(_.match(),M.currentIndexCard+=1,M.currentIndexCard>=M.cardsAudio.length?M.mistakes>0?(_.lose(),"lose"):(_.win(),"win"):(M.playCurrentAudio(1e3),"match")):(_.mistake(),M.mistakes+=1,"mistake"),M.getCursorIndexCard=()=>M.indices[M.currentIndexCard],M.playCurrentAudio=e=>{let t=500;e&&(t=e),setTimeout((()=>{new Audio(M.cardsAudio[M.getCursorIndexCard()]).play()}),t)},M.fillIndeces=()=>{const e=[];for(let t=0;t<M.cardsAudio.length;t++)e.push(t);return(t=e)&&t.sort((()=>Math.random()-.5)),t;var t},M.getCountMistakes=()=>M.mistakes;class R extends o{constructor(e){super("div",["page-cards"]),this.nameRouter=e,this.cards=[],this.cardsAudio=[],this.initPageCards=()=>{this.createSmileLose(),this.createSmileWin()},this.setEventsToElement=()=>{this.btnStart.addEventListener("click",this.onClickBtnStart),this.btnRepeat.addEventListener("click",this.onClickBtnRepeat)},this.onClickCard=e=>{const t=e.currentTarget,r=Number(t.dataset.id);if(d.isPlayMode()||(this.cards[r].cardAudio.play(),E.incrementClickedTimesOfWord(this.cards[r].nameRouter,this.cards[r].categoryWord.idWord)),d.isGameStart()){const e=M.checkStatus(this.cardsAudio[r]);"mistake"!==e&&this.isStatusCardNotMistake(r,t),"mistake"===e&&this.isStatusCardMistake(),"win"===e&&this.isStatusCardWin(),"lose"===e&&this.isStatusCardLose()}},this.isStatusCardNotMistake=(e,t)=>{this.cards[e].element.removeEventListener("click",this.onClickCard),t.classList.add("matched"),this.starsContainer.addStarMatch(),E.addMatchedToWord(this.cards[e].nameRouter,this.cards[e].categoryWord.idWord)},this.isStatusCardMistake=()=>{this.starsContainer.addStarMistake(),E.incrementMistakeTimesOfWord(this.cards[M.getCursorIndexCard()].nameRouter,this.cards[M.getCursorIndexCard()].categoryWord.idWord)},this.isStatusCardWin=()=>{d.stopGame(),this.wrapperForCards.element.innerHTML="",this.wrapperForCards.element.appendChild(this.smileWin.element),this.redirectToPageCategory()},this.isStatusCardLose=()=>{d.stopGame(),this.wrapperForCards.element.innerHTML="",this.smileLose.setTextMessage(`You made ${M.getCountMistakes()} mistakes`),this.wrapperForCards.element.appendChild(this.smileLose.element),this.redirectToPageCategory()},this.onClickBtnStart=()=>{d.startGame(),this.btnStart.classList.remove("show"),this.btnRepeat.classList.add("show"),M.start(this.cardsAudio)},this.onClickBtnRepeat=()=>{M.playCurrentAudio(100)},this.renderPageCardsElements=()=>{this.renderWrapperForStars(),this.renderStarsContainer(),this.renderWrapperForCards(),this.renderPageCards(),this.renderWrapperForBtn(),this.renderBtnStart(),this.renderBtnRepeat()},this.renderWrapperForStars=()=>{this.wrapperForStars=new o("div",["page-cards__wrapper-for-stars"]),this.wrapperForStars.render(this.element)},this.renderStarsContainer=()=>{this.starsContainer=new S,this.starsContainer.render(this.wrapperForStars.element)},this.renderWrapperForCards=()=>{this.wrapperForCards=new o("div",["page-cards__wrapper-for-cards"]),this.wrapperForCards.render(this.element)},this.renderPageCards=()=>{this.cardsAudio=[],this.cards=[],"repeat"!==this.nameRouter?T(this.nameRouter).then((e=>{e.words.forEach(((t,r)=>{const i=new W(e.nameRouter,t,String(r));i.render(this.wrapperForCards.element),i.element.addEventListener("click",this.onClickCard),this.cardsAudio.push(i.cardAudio.src),this.cards.push(i)}))})):E.getListRepeatWords().forEach(((e,t)=>{const r=new W(e.nameRouter,e.categoryWord,String(t));r.render(this.wrapperForCards.element),r.element.addEventListener("click",this.onClickCard),this.cardsAudio.push(r.cardAudio.src),this.cards.push(r)}))},this.renderWrapperForBtn=()=>{this.wrapperForBtn=new o("div",["page-cards__wrapper-for-btn"]),this.wrapperForBtn.render(this.element)},this.renderBtnStart=()=>{this.btnStart=document.createElement("button"),this.btnStart.classList.add("btn"),this.btnStart.classList.add("show"),this.btnStart.innerHTML="Start",this.wrapperForBtn.element.appendChild(this.btnStart)},this.renderBtnRepeat=()=>{this.btnRepeat=document.createElement("button"),this.btnRepeat.classList.add("btn"),this.btnRepeat.classList.add("btn-repeat"),this.wrapperForBtn.element.appendChild(this.btnRepeat)},this.createSmileLose=()=>{this.smileLose=new y("You LOSE :(")},this.createSmileWin=()=>{this.smileWin=new f("You WIN !!!")},this.redirectToPageCategory=()=>{this.btnRepeat.classList.remove("show"),setTimeout((()=>{window.location.href="#categories"}),4e3)},this.renderPageCardsElements(),this.initPageCards(),this.setEventsToElement()}}const A=async e=>{const t=await fetch("https://www.maks-t.com/api/updatecategory",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()};class P extends o{constructor(e,t=!1,r="#",i=0,s=""){super("div",["card-category-admin"]),this.categoryName=e,this.isCreatedCard=t,this.wordRouter=r,this.countWord=i,this.idCategory=s,this.initComponent=()=>{this.isCreatedCard&&this.toggleSideCard()},this.setEventsElements=()=>{this.btnCancel.element.addEventListener("click",this.onClickBtnCancel),this.btnCreate.element.addEventListener("click",this.onClickBtnCreate),this.btnRemove.element.addEventListener("click",this.onClickBtnRemove),this.btnUpdate.element.addEventListener("click",this.onClickBtnUpdate),this.btnAddWord.element.addEventListener("click",this.onClickBtnAddWord)},this.onClickBtnCancel=()=>{this.isCreatedCard?this.toggleSideCard():this.element.remove()},this.onClickBtnCreate=()=>{if(this.categoryName=this.inputNameCategory.element.value,this.headerCard.element.innerHTML=this.categoryName,this.isCreatedCard)T(this.wordRouter).then((e=>{this.categoryName=this.inputNameCategory.element.value,this.wordRouter=this.categoryName.toLowerCase().replace(" ","-"),e.nameCategory=this.categoryName,e.nameRouter=this.wordRouter,A(e),this.toggleSideCard()}));else{const e={nameCategory:this.categoryName,nameRouter:this.categoryName.toLowerCase().replace(" ","-"),words:[]};(async e=>{const t=await fetch("https://www.maks-t.com/api/addcategory",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()})(e).then((e=>{e.message===p.CATEGORY_ERROR_ALREADY_CREATED&&(alert(`ERROR! Category with name : ${this.categoryName} already Created!!!`),this.onClickBtnRemove()),e.message===p.CATEGORY_SUCCES_CREATED&&(this.isCreatedCard=!0,this.toggleSideCard())})).finally((()=>{T(e.nameRouter).then((e=>{this.wordRouter=e.nameRouter,v.registerRouter(`admin-categories/${e.nameRouter}`,m.routerAdminWords),this.idCategory=String(e._id),this.btnCreate.element.innerHTML="Update"}))})).catch((()=>{this.onClickBtnRemove()}))}},this.onClickBtnRemove=()=>{this.isCreatedCard?(async e=>{const t=await fetch(`https://www.maks-t.com/api/deletecategory/${e}`,{method:"DELETE"});return await t.json()})(this.idCategory).then((()=>{this.element.remove()})):this.element.remove()},this.onClickBtnUpdate=()=>{this.inputNameCategory.element.value=this.categoryName,this.btnCreate.element.innerHTML="Update",this.toggleSideCard()},this.onClickBtnAddWord=()=>{window.location.href=`#admin-categories/${this.wordRouter}`},this.renderCardElements=()=>{this.renderSideCreateCard(),this.renderSideMainCard()},this.renderSideCreateCard=()=>{this.sideCreateCard=new o("div",["card-category-admin__side-create-card"]),this.sideCreateCard.render(this.element),this.renderLabelCategory(),this.renderInputNameCategory(),this.renderWrapperForBtnCreateSide()},this.renderLabelCategory=()=>{this.labelCategory=new o("label",["card-category-admin__label-category"]),this.labelCategory.element.innerHTML="Category Name:",this.labelCategory.render(this.sideCreateCard.element)},this.renderInputNameCategory=()=>{this.inputNameCategory=new o("input",["card-category-admin__input-name-category"]),this.inputNameCategory.element.setAttribute("value","new-category"),this.inputNameCategory.render(this.sideCreateCard.element)},this.renderWrapperForBtnCreateSide=()=>{this.wrapperForBtnCreateSide=new o("div",["card-category-admin__wrapper-for-btn-create-side"]),this.wrapperForBtnCreateSide.render(this.sideCreateCard.element),this.renderBtnCancel(),this.renderBtnCreate()},this.renderBtnCancel=()=>{this.btnCancel=new o("button",["card-category-admin__btn-cancel"]),this.btnCancel.element.innerHTML="Cancel",this.btnCancel.render(this.wrapperForBtnCreateSide.element)},this.renderBtnCreate=()=>{this.btnCreate=new o("button",["card-category-admin__btn-create"]),this.isCreatedCard&&(this.btnCreate.element.innerHTML="Update"),this.btnCreate.element.innerHTML="Create",this.btnCreate.render(this.wrapperForBtnCreateSide.element)},this.renderSideMainCard=()=>{this.sideMainCard=new o("div",["card-category-admin__side-main-card","hide"]),this.sideMainCard.render(this.element),this.renderHeaderCard(),this.renderBtnRemove(),this.renderCountWordElement(),this.renderWrapperForBtnMainSide()},this.renderHeaderCard=()=>{this.headerCard=new o("p",["card-category-admin__header-card"]),this.headerCard.element.innerHTML=this.categoryName,this.headerCard.render(this.sideMainCard.element)},this.renderBtnRemove=()=>{this.btnRemove=new o("div",["card-category-admin__btn-remove"]),this.btnRemove.render(this.sideMainCard.element)},this.renderCountWordElement=()=>{this.countWordElement=new o("div",["card-category-admin__count-word"]),this.countWordElement.element.innerHTML="WORDS: "+this.countWord,this.countWordElement.render(this.sideMainCard.element)},this.renderWrapperForBtnMainSide=()=>{this.wrapperForBtnMainSide=new o("div",["card-category-admin__wrapper-for-btn-main-side"]),this.wrapperForBtnMainSide.render(this.sideMainCard.element),this.renderBtnUpdate(),this.renderBtnAddWord()},this.renderBtnUpdate=()=>{this.btnUpdate=new o("button",["card-category-admin__btn-update"]),this.btnUpdate.element.innerHTML="Update",this.btnUpdate.render(this.wrapperForBtnMainSide.element)},this.renderBtnAddWord=()=>{this.btnAddWord=new o("button",["card-category-admin__btn-add-word"]),this.btnAddWord.element.innerHTML="Add Word",this.btnAddWord.render(this.wrapperForBtnMainSide.element)},this.toggleSideCard=()=>{this.sideCreateCard.element.classList.toggle("hide"),this.sideMainCard.element.classList.toggle("hide")},this.renderCardElements(),this.setEventsElements(),this.initComponent()}}class B extends o{constructor(){super("div",["card-new-category-admin"]),this.renderCardElements=()=>{this.headerCard=new o("p",["card-new-category-admin__header-card"]),this.headerCard.element.innerHTML="Create new Category",this.headerCard.render(this.element),this.btnAddNewCategory=new o("button",["card-new-category-admin__btn-add-new-card"]),this.btnAddNewCategory.render(this.element)},this.renderCardElements()}}class F{constructor(e=[],t,r,i=2){this.items=e,this.parentElement=t,this.afterElement=r,this.step=i,this.cursor=0,this.loadMoreElements=e=>{let t=this.step;e&&(t=e);const r=t+this.cursor;if(this.cursor<=this.items.length){for(;this.cursor<r&&this.cursor<this.items.length;this.cursor++)this.items[this.cursor].render(this.parentElement);this.parentElement.appendChild(this.afterElement)}},this.loadAllElements=()=>{if(this.cursor<=this.items.length){for(;this.cursor<this.items.length;this.cursor++)this.items[this.cursor].render(this.parentElement);this.parentElement.appendChild(this.afterElement)}}}}class N extends o{constructor(){super("div",["page-categories-admin"]),this.cardCategories=[],this.setEventsToElement=()=>{this.cardCategoryNew.btnAddNewCategory.element.addEventListener("click",this.onClickBtnNewCategory),this.element.addEventListener("wheel",this.onScrollCategories)},this.onClickBtnNewCategory=()=>{this.currentCreatedCategory&&!this.currentCreatedCategory.isCreatedCard&&this.currentCreatedCategory.onClickBtnCreate(),this.currentCreatedCategory=new P("new category"),this.cardCategories.push(this.currentCreatedCategory),this.infinityScroll.loadAllElements()},this.onScrollCategories=()=>{this.element.scrollTop+this.element.clientHeight>=this.element.scrollHeight&&setTimeout((()=>{this.infinityScroll.loadMoreElements(1)}),600)},this.renderPageCategoriesElements=()=>{this.renderWrapperForCategories()},this.renderWrapperForCategories=()=>{this.wrapperForCategories=new o("div",["page-categories-admin__wrapper-for-categories"]),this.wrapperForCategories.render(this.element),this.renderCategories(),this.renderCardCategoryNew()},this.renderCategories=async()=>{c().then((e=>{e.forEach((e=>{const t=e.words.length,r=new P(e.nameCategory,!0,e.nameRouter,t,String(e._id));this.cardCategories.push(r)})),this.infinityScroll.loadMoreElements(5)}))},this.renderCardCategoryNew=()=>{this.cardCategoryNew=new B,this.cardCategoryNew.render(this.wrapperForCategories.element)},this.renderPageCategoriesElements(),this.infinityScroll=new F(this.cardCategories,this.wrapperForCategories.element,this.cardCategoryNew.element),this.setEventsToElement()}}class H extends o{constructor(e){super("a",["page-categories__category"]),this.nameRouter=e,this.renderElements=()=>{T(this.nameRouter).then((e=>{this.element.setAttribute("href",`#${this.nameRouter}`),this.imgCategory=new o("img",["page-categories__category-img"]);let t="./assets/images/unnamed.jpg";e.words.length>0&&(t="https://www.maks-t.com/"+e.words[0].picture),this.imgCategory.element.setAttribute("src",t),this.imgCategory.element.setAttribute("alt",e.nameCategory),this.imgCategory.render(this.element),this.element.innerHTML+=e.nameCategory}))},this.renderElements()}}class I extends o{constructor(){super("div",["page-categories"]),this.categories=[],this.setEventsToElement=()=>{},this.renderPageCategoriesElements=()=>{this.renderWrapperForCategories(),this.renderCategories()},this.renderWrapperForCategories=()=>{this.wrapperForCategories=new o("div",["page-categories__wrapper-for-categories"]),this.wrapperForCategories.render(this.element)},this.renderCategories=()=>{c().then((e=>{e.forEach((e=>{const t=new H(e.nameRouter);t.render(this.wrapperForCategories.element),this.categories.push(t)}))}))},this.renderPageCategoriesElements(),this.setEventsToElement()}}class O extends o{constructor(e){super("div",["dialog-popup"]),this.okClickCallback=e,this.addEventsToDialogPopupElements=()=>{this.btnOk.element.addEventListener("click",this.onClickBtnOk),this.btnCancel.element.addEventListener("click",this.onClickBtnCancel)},this.initDialogPopup=()=>{this.render(document.body),this.hide()},this.renderDialogPopupElements=()=>{this.renderPopup(),this.renderPopupHeader(),this.renderPopupText(),this.renderBtns()},this.renderPopup=()=>{this.popup=new o("div",["popup"]),this.popup.render(this.element)},this.renderPopupHeader=()=>{this.popupHeader=new o("div",["popup-header"]),this.popupHeader.element.innerHTML="WARNING!",this.popupHeader.render(this.popup.element)},this.renderPopupText=()=>{this.popupText=new o("div",["popup-text"]),this.popupText.render(this.popup.element)},this.renderBtns=()=>{this.wrapperForBtn=new o("div",["wrapper-for-btn"]),this.wrapperForBtn.render(this.popup.element),this.btnOk=new o("button",["btn-ok"]),this.btnOk.element.innerHTML="ok",this.btnOk.render(this.wrapperForBtn.element),this.btnCancel=new o("button",["btn-cancel"]),this.btnCancel.element.innerHTML="cancel",this.btnCancel.render(this.wrapperForBtn.element)},this.onClickBtnOk=()=>{this.hide(),this.okClickCallback&&this.okClickCallback()},this.onClickBtnCancel=()=>{this.hide()},this.initDialogPopup(),this.renderDialogPopupElements(),this.addEventsToDialogPopupElements()}hide(){document.body.classList.remove("notscrollable"),this.element.classList.add("hide")}show(e){this.popupText.element.innerHTML=e,document.body.classList.add("notscrollable"),this.element.classList.remove("hide")}}const x=["num","category","word","translate","clicked","mathed","mistakes","percent"];class G extends o{constructor(e){super("table",["page-stat__stat-table"]),this.listWord=e,this.listCellsHeader=x,this.renderStatTableElements=()=>{this.element.innerHTML="",this.renderHeaderCells(),this.renderTableCells()},this.renderHeaderCells=()=>{if(!this.rowHeader){const e=this.element.createTHead();this.rowHeader=e.insertRow(0),this.listCellsHeader.forEach((e=>{const t=this.rowHeader.insertCell();t.id=e,t.innerHTML=e,this.rowHeader.append(t)}))}},this.renderTableCells=()=>{const e=this.element;this.rowHeader&&e.createTHead().append(this.rowHeader),this.listWord.forEach(((t,r)=>{const i=e.insertRow();i.insertCell().innerHTML=String(r+1),i.insertCell().innerHTML=t.nameCategory,i.insertCell().innerHTML=t.categoryWord.langEN,i.insertCell().innerHTML=t.categoryWord.langRU,i.insertCell().innerHTML=String(t.clicked),i.insertCell().innerHTML=String(t.matched),i.insertCell().innerHTML=String(t.mistakes),i.insertCell().innerHTML=String(t.percent),e.appendChild(i)}))},this.onClickRowHeader=e=>{const t=e.target;t&&(this.rowHeader.querySelectorAll("td").forEach((e=>{e.id!==t.id&&(e.classList.remove("up-sort"),e.classList.remove("down-sort"))})),this.compareIdElement=t.id,"num"!==t.id&&this.clickRowCellHeader(t))},this.clickRowCellHeader=e=>{const t=e,r=[...this.listWord];t.classList.contains("down-sort")?(this.listWord.sort(this.byAscending),this.renderStatTableElements(),t.classList.remove("down-sort"),t.classList.add("up-sort")):t.classList.contains("up-sort")?(this.renderStatTableElements(),t.classList.remove("up-sort")):(this.listWord.sort(this.byDescending),this.renderStatTableElements(),t.classList.add("down-sort")),this.listWord=[...r]},this.byAscending=(e,t)=>{const r=this.switchComareElement(e,t);return r.a>r.b?1:r.a<r.b?-1:0},this.byDescending=(e,t)=>{const r=this.switchComareElement(e,t);return r.a<r.b?1:r.a>r.b?-1:0},this.switchComareElement=(e,t)=>{let r,i;switch(this.compareIdElement){case"category":r=e.nameCategory,i=t.nameCategory;break;case"word":r=e.categoryWord.langEN,i=t.categoryWord.langEN;break;case"translate":r=e.categoryWord.langRU,i=t.categoryWord.langRU;break;case"clicked":r=e.clicked,i=t.clicked;break;case"mathed":r=e.matched,i=t.matched;break;case"mistakes":r=e.mistakes,i=t.mistakes;break;case"percent":r=e.percent,i=t.percent;break;default:r=e.nameCategory,i=t.nameCategory}return{a:r,b:i}},this.renderStatTableElements(),this.rowHeader.addEventListener("click",this.onClickRowHeader)}}class D extends o{constructor(){super("div",["page-stat"]),this.addEventsToPageStatElements=()=>{this.btnRepeatWord.addEventListener("click",this.onClickBtnRepeatWord),this.btnReset.addEventListener("click",this.onClickBtnReset)},this.onClickBtnRepeatWord=()=>{window.location.href="#repeat"},this.onClickBtnReset=()=>{this.dialogPopup.show("\n    Are you sure? <br/>\n    All statistics data will be deleted!")},this.renderPageStatElements=()=>{this.renderBtnRepeatWord(),this.renderBtnReset(),this.renderStatTable()},this.renderStatTable=()=>{this.statTable=new G(E.getListWords()),this.statTable.render(this.element)},this.renderBtnRepeatWord=()=>{this.btnRepeatWord=document.createElement("button"),this.btnRepeatWord.classList.add("page-stat__btn"),this.btnRepeatWord.innerHTML="Repeat difficult word",this.element.append(this.btnRepeatWord)},this.renderBtnReset=()=>{this.btnReset=document.createElement("button"),this.btnReset.classList.add("page-stat__btn"),this.btnReset.classList.add("btn-reset"),this.btnReset.innerHTML="Reset statistics",this.element.append(this.btnReset)},this.createDialogPopup=()=>{this.dialogPopup=new O(this.resetSatistics)},this.resetSatistics=()=>{E.resetStatistics(),this.statTable.renderStatTableElements()},this.renderPageStatElements(),this.addEventsToPageStatElements(),this.createDialogPopup()}}class U extends o{constructor(){super("div",["card-new-word-admin"]),this.renderCardElements=()=>{this.headerCard=new o("p",["card-new-word-admin__header-card"]),this.headerCard.element.innerHTML="Create new Category",this.headerCard.render(this.element),this.btnAddNewWord=new o("button",["card-new-word-admin__btn-add-new-card"]),this.btnAddNewWord.render(this.element)},this.renderCardElements()}}var V,j=new Uint8Array(16);function $(){if(!V&&!(V="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return V(j)}const Y=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,q=function(e){return"string"==typeof e&&Y.test(e)};for(var J=[],K=0;K<256;++K)J.push((K+256).toString(16).substr(1));var z,Q,X=0,Z=0;const ee=function(e,t,r){var i=t&&r||0,s=t||new Array(16),n=(e=e||{}).node||z,a=void 0!==e.clockseq?e.clockseq:Q;if(null==n||null==a){var d=e.random||(e.rng||$)();null==n&&(n=z=[1|d[0],d[1],d[2],d[3],d[4],d[5]]),null==a&&(a=Q=16383&(d[6]<<8|d[7]))}var o=void 0!==e.msecs?e.msecs:Date.now(),h=void 0!==e.nsecs?e.nsecs:Z+1,l=o-X+(h-Z)/1e4;if(l<0&&void 0===e.clockseq&&(a=a+1&16383),(l<0||o>X)&&void 0===e.nsecs&&(h=0),h>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");X=o,Z=h,Q=a;var c=(1e4*(268435455&(o+=122192928e5))+h)%4294967296;s[i++]=c>>>24&255,s[i++]=c>>>16&255,s[i++]=c>>>8&255,s[i++]=255&c;var m=o/4294967296*1e4&268435455;s[i++]=m>>>8&255,s[i++]=255&m,s[i++]=m>>>24&15|16,s[i++]=m>>>16&255,s[i++]=a>>>8|128,s[i++]=255&a;for(var p=0;p<6;++p)s[i+p]=n[p];return t||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(J[e[t+0]]+J[e[t+1]]+J[e[t+2]]+J[e[t+3]]+"-"+J[e[t+4]]+J[e[t+5]]+"-"+J[e[t+6]]+J[e[t+7]]+"-"+J[e[t+8]]+J[e[t+9]]+"-"+J[e[t+10]]+J[e[t+11]]+J[e[t+12]]+J[e[t+13]]+J[e[t+14]]+J[e[t+15]]).toLowerCase();if(!q(r))throw TypeError("Stringified UUID is invalid");return r}(s)};class te extends o{constructor(e){super("div",["card-word-admin"]),this.nameCategory=e,this.isCreatedCard=!1,this.setEventsToElements=()=>{this.sideCreateCard.element.addEventListener("submit",this.onFormWordSumbit),this.btnRemove.element.addEventListener("click",this.onClickBtnRemove),this.btnCancel.element.addEventListener("click",this.onClickBtnCancel)},this.onFormWordSumbit=async e=>{e.preventDefault();const t=await(async e=>{const t=await fetch("https://www.maks-t.com/api/createword",{method:"POST",body:new FormData(e)});return await t.json()})(this.sideCreateCard.element);this.word=t;const r=await T(this.nameCategory);if(this.isCreatedCard){this.createSideMainCard(t);const e=r.words.findIndex((e=>t.idWord===e.idWord));r.words[e]=t,A(r)}this.isCreatedCard||(this.createSideMainCard(t),r.words.push(t),A(r),this.btnCreate.element.value="Update")},this.onClickBtnRemove=async()=>{if(this.isCreatedCard){const e=await T(this.nameCategory);e.words=e.words.filter((e=>e.idWord!==this.word.idWord)),A(e)}this.element.remove()},this.onClickBtnCancel=()=>{this.isCreatedCard?this.toggleSideCard():this.element.remove()},this.createSideMainCard=e=>{this.word=e,this.idWordName.element.value=this.word.idWord,this.renderSideMainCard(),this.setEventsToSideMain(),this.isCreatedCard=!0,this.toggleSideCard()},this.setEventsToSideMain=()=>{this.soundValue.element.addEventListener("click",this.onClickSoundPlay),this.btnChange.element.addEventListener("click",this.onClickBtnChange)},this.onClickBtnChange=()=>{this.isCreatedCard&&(this.btnCreate.element.value="Update"),this.toggleSideCard()},this.onClickSoundPlay=()=>{this.audioElement.element.play()},this.renderCardElements=()=>{this.renderBtnRemove(),this.renderSideCreateCard()},this.renderBtnRemove=()=>{this.btnRemove=new o("div",["card-word-admin__btn-remove"]),this.btnRemove.render(this.element)},this.renderSideCreateCard=()=>{this.sideCreateCard=new o("form",["card-word-admin__side-create"]),this.sideCreateCard.element.id="formWord",this.sideCreateCard.element.setAttribute("method","post"),this.sideCreateCard.element.setAttribute("enctype","multipart/form-data"),this.sideCreateCard.render(this.element),this.renderIdWordName(),this.renderLabelWord(),this.renderInputWord(),this.renderLabelTranslate(),this.renderInputTranslate(),this.renderWrapperInputLoadSound(),this.renderWrapperInputLoadImage(),this.renderWrapperForBtnCreateSide()},this.renderIdWordName=()=>{this.idWordName=new o("input",["card-word-admin__id-word-name"]),this.idWordName.element.setAttribute("required",""),this.idWordName.element.value=ee(),this.idWordName.element.name="idWord",this.idWordName.element.type="text",this.idWordName.render(this.sideCreateCard.element)},this.renderLabelWord=()=>{this.labelWord=new o("label",["card-word-admin__label-word"]),this.labelWord.element.innerHTML="Word:",this.labelWord.render(this.sideCreateCard.element)},this.renderInputWord=()=>{this.inputWord=new o("input",["card-word-admin__input-word"]),this.inputWord.element.setAttribute("required",""),this.inputWord.element.value="Draw",this.inputWord.element.name="langRU",this.inputWord.element.type="text",this.inputWord.render(this.sideCreateCard.element)},this.renderLabelTranslate=()=>{this.labelTranslate=new o("label",["card-word-admin__label-translate"]),this.labelTranslate.element.innerHTML="Translation",this.labelTranslate.render(this.sideCreateCard.element)},this.renderInputTranslate=()=>{this.inputTranslate=new o("input",["card-word-admin__input-translate"]),this.inputTranslate.element.setAttribute("required",""),this.inputTranslate.element.value="Рисовать",this.inputTranslate.element.name="langEN",this.inputTranslate.element.type="text",this.inputTranslate.render(this.sideCreateCard.element)},this.renderWrapperInputLoadSound=()=>{this.wrapperInputLoadSound=new o("div",["card-word-admin__wrapper-input-sound"]),this.wrapperInputLoadSound.render(this.sideCreateCard.element),this.renderLabelLoadSound(),this.renderInputLoadSound()},this.renderLabelLoadSound=()=>{this.labelLoadSound=new o("label",["card-word-admin__label-load-sound"]),this.labelLoadSound.element.innerHTML="Sound: ",this.labelLoadSound.render(this.wrapperInputLoadSound.element)},this.renderInputLoadSound=()=>{this.inputLoadSound=new o("input",["card-word-admin__input-load-sound"]),this.inputLoadSound.element.setAttribute("required",""),this.inputLoadSound.element.name="sound",this.inputLoadSound.element.accept="audio/*",this.inputLoadSound.element.type="file",this.inputLoadSound.render(this.wrapperInputLoadSound.element)},this.renderWrapperInputLoadImage=()=>{this.wrapperInputLoadImage=new o("div",["card-word-admin__wrapper-input-image"]),this.wrapperInputLoadImage.render(this.sideCreateCard.element),this.renderLabelLoadImage(),this.renderInputLoadImage()},this.renderLabelLoadImage=()=>{this.labelLoadImage=new o("label",["card-word-admin__label-load-image"]),this.labelLoadImage.element.innerHTML="Image: ",this.labelLoadImage.render(this.wrapperInputLoadImage.element)},this.renderInputLoadImage=()=>{this.inputLoadImage=new o("input",["card-word-admin__input-load-image"]),this.inputLoadImage.element.name="picture",this.inputLoadImage.element.accept="image/*",this.inputLoadImage.element.type="file",this.inputLoadImage.render(this.wrapperInputLoadImage.element)},this.renderWrapperForBtnCreateSide=()=>{this.wrapperForBtnCreateSide=new o("div",["card-word-admin__wrapper-for-btn-create-side"]),this.wrapperForBtnCreateSide.render(this.sideCreateCard.element),this.renderBtnCancel(),this.renderBtnCreate()},this.renderBtnCancel=()=>{this.btnCancel=new o("input",["card-word-admin__btn-cancel"]),this.btnCancel.element.value="Cancel",this.btnCancel.element.type="button",this.btnCancel.render(this.wrapperForBtnCreateSide.element)},this.renderBtnCreate=()=>{this.btnCreate=new o("input",["card-word-admin__btn-create"]),this.btnCreate.element.value="Create",this.btnCreate.element.type="submit",this.btnCreate.render(this.wrapperForBtnCreateSide.element)},this.renderSideMainCard=()=>{this.sideMainCard=new o("div",["card-word-admin__side-main","hide"]),this.sideMainCard.render(this.element),this.renderWordWrapper(),this.renderTraslateWrapper(),this.renderSoundWrapper(),this.renderPictureName(),this.renderPictureValue(),this.renderBtnChange()},this.renderWordWrapper=()=>{this.wordWrapper=new o("div",["card-word-admin__word-wrapper"]),this.wordWrapper.render(this.sideMainCard.element),this.renderWordName(),this.renderWordValue()},this.renderWordName=()=>{this.wordName=new o("div",["card-word-admin__word-name"]),this.wordName.element.innerHTML="Word: ",this.wordName.render(this.wordWrapper.element)},this.renderWordValue=()=>{this.wordValue=new o("div",["card-word-admin__word-value"]),this.wordValue.element.innerHTML=this.word.langEN,this.wordValue.render(this.wordWrapper.element)},this.renderTraslateWrapper=()=>{this.traslateWrapper=new o("div",["card-word-admin__traslate-wrapper"]),this.traslateWrapper.render(this.sideMainCard.element),this.renderTraslateName(),this.renderTraslateValue()},this.renderTraslateName=()=>{this.traslateName=new o("div",["card-word-admin__traslate-name"]),this.traslateName.element.innerHTML="Translation: ",this.traslateName.render(this.traslateWrapper.element)},this.renderTraslateValue=()=>{this.traslateValue=new o("div",["card-word-admin__traslate-value"]),this.traslateValue.element.innerHTML=this.word.langRU,this.traslateValue.render(this.traslateWrapper.element)},this.renderSoundWrapper=()=>{this.soundWrapper=new o("div",["card-word-admin__sound-wrapper"]),this.soundWrapper.render(this.sideMainCard.element),this.audioElement=new o("audio",["card-word-admin__audio-element"]),this.audioElement.element.src=`https://www.maks-t.com/${this.word.sound}`,this.renderSoundName(),this.renderSoundValue()},this.renderSoundName=()=>{this.soundName=new o("div",["card-word-admin__sound-name"]),this.soundName.element.innerHTML="Sound File: ",this.soundName.render(this.soundWrapper.element)},this.renderSoundValue=()=>{this.soundValue=new o("div",["card-word-admin__sound-value"]),this.soundValue.render(this.soundWrapper.element)},this.renderPictureName=()=>{this.pictureName=new o("div",["card-word-admin__picture-name"]),this.pictureName.element.innerHTML="Image: ",this.pictureName.render(this.sideMainCard.element)},this.renderPictureValue=()=>{this.pictureValue=new o("img",["card-word-admin__picture-value"]),this.pictureValue.element.src=`https://www.maks-t.com/${this.word.picture}`,this.pictureValue.render(this.sideMainCard.element)},this.renderBtnChange=()=>{this.btnChange=new o("button",["card-word-admin__btn-change"]),this.btnChange.element.innerHTML="Change",this.btnChange.render(this.sideMainCard.element)},this.toggleSideCard=()=>{this.sideCreateCard.element.classList.toggle("hide"),this.sideMainCard.element.classList.toggle("hide")},this.renderCardElements(),this.setEventsToElements()}}class re extends o{constructor(e){super("div",["page-words-admin"]),this.nameCategory=e,this.cardsWord=[],this.setEventsToElements=()=>{this.cardNewWord.btnAddNewWord.element.addEventListener("click",this.onClickBtnAddNewWord),this.element.addEventListener("wheel",this.onScrollWords)},this.onClickBtnAddNewWord=()=>{(!this.currentCreatedWord||this.currentCreatedWord&&this.currentCreatedWord.isCreatedCard)&&(this.currentCreatedWord=new te(this.nameCategory),this.cardsWord.push(this.currentCreatedWord),this.infinityScroll.loadAllElements())},this.onScrollWords=()=>{this.element.scrollTop+this.element.clientHeight>=this.element.scrollHeight&&setTimeout((()=>{this.infinityScroll.loadMoreElements(1)}),600)},this.renderPageWordsElements=()=>{this.renderCategoryHeader(),this.renderWrapperForWords()},this.renderCategoryHeader=()=>{this.categoryHeader=new o("h2",["page-words-admin__category-name"]),this.categoryHeader.element.innerHTML=`Category: ${this.nameCategory}`,this.categoryHeader.render(this.element)},this.renderWrapperForWords=()=>{this.wrapperForWords=new o("div",["page-words-admin__wrapper-for-categories"]),this.wrapperForWords.render(this.element),this.renderCardWordsNew(),T(this.nameCategory).then((e=>{e.words.forEach((e=>{this.currentCreatedWord=new te(this.nameCategory),this.cardsWord.push(this.currentCreatedWord),this.currentCreatedWord.createSideMainCard(e)})),this.infinityScroll.loadMoreElements(4)}))},this.renderCardWordsNew=()=>{this.cardNewWord=new U,this.cardNewWord.render(this.wrapperForWords.element)},this.renderPageWordsElements(),this.setEventsToElements(),this.infinityScroll=new F(this.cardsWord,this.wrapperForWords.element,this.cardNewWord.element)}}const ie=window.location.hash.slice(1),se=new class{constructor(e){this.container=document.body,this.setEventToElements=()=>{this.header.toggleSwitch.element.addEventListener("change",this.onChangeToggleSwitch),this.loginForm.element.addEventListener("submit",this.onSubmitLoginForm),this.header.btnLogOut.element.addEventListener("click",this.onCLickBtnLogOut)},this.onChangeToggleSwitch=()=>{this.container.classList.toggle("play"),d.toggleAppMode(),d.stopGame()},this.onSubmitLoginForm=e=>{e.preventDefault();const t={login:this.loginForm.inputLogin.value,password:this.loginForm.inputPassword.value};(async e=>{const t=await fetch("https://www.maks-t.com/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()})(t).then((e=>{if(e.message===p.LOGIN_SUCCES){const r={login:t.login,id:String(e.id)};window.localStorage.setItem("loginData",JSON.stringify(r)),d.setLoginTrue(),this.loginForm.hideForm(),window.location.href="#admin-categories"}e.message===p.LOGIN_ERROR&&(this.loginForm.messageForm.element.innerHTML="wrong login or password")})),this.header.btnAdminPanel.element.classList.remove("hide"),this.header.btnAdminPanel.element.classList.remove("hide")},this.onCLickBtnLogOut=()=>{window.localStorage.removeItem("loginData"),d.setLoginFalse(),this.header.btnLogOut.element.classList.add("hide"),this.header.btnAdminPanel.element.classList.add("hide"),this.loginForm.btnOk.value="Login"},this.onCancelLoginForm=e=>{e.preventDefault()},this.createAppElements=()=>{this.createWrapperMainPages(),this.createHeader(),this.createMain(),this.createMainWrapper(),this.createLoginForm(),this.createFooter(),this.createWrapperAdminPages(),this.createHeaderAdmin(),this.createMainAdmin(),this.createPageCategoriesAdmin()},this.createWrapperMainPages=()=>{this.wrapperMainPages=new o("div",["wrapper-main-pages"])},this.createHeader=()=>{this.header=new L("header")},this.createFooter=()=>{this.footer=new l("footer")},this.createMain=()=>{this.main=document.createElement("main")},this.createMainWrapper=()=>{this.mainWrapper=document.createElement("div"),this.mainWrapper.classList.add("main__wrapper")},this.createPageCategories=()=>{this.setActiveLinkToPageCategories(),this.pageCategories=new I},this.createPageCards=()=>{this.setActiveLinkToPageCards();const e=this.idPage.substring(this.idPage.lastIndexOf("/")+1);this.pageCards=new R(e)},this.createPageStat=()=>{this.setActiveLinkToPageStatistics(),this.pageStat=new D},this.createLoginForm=()=>{this.loginForm=new b},this.createWrapperAdminPages=()=>{this.wrapperAdminPages=new o("div",["wrapper-admin-pages","hide"])},this.createHeaderAdmin=()=>{this.headerAdmin=new h},this.createMainAdmin=()=>{this.mainAdmin=document.createElement("main")},this.createPageCategoriesAdmin=()=>{this.pageCategoriesAdmin=new N},this.routerStatisctics=()=>{this.mainWrapper.innerHTML="",this.createPageStat(),this.pageStat.render(this.mainWrapper)},this.routerCategories=()=>{this.mainWrapper.innerHTML="",this.createPageCategories(),this.pageCategories.render(this.mainWrapper)},this.routerAdminCategories=()=>{d.isLogin()?(this.headerAdmin.linkWords.element.classList.remove("active-link"),this.wrapperMainPages.element.classList.add("hide"),this.wrapperAdminPages.element.classList.remove("hide"),this.mainAdmin.innerHTML="",this.pageCategoriesAdmin.render(this.mainAdmin)):(this.mainWrapper.innerHTML="You are not logged in!",window.location.href="#categories")},this.routerAdminWords=()=>{if(d.isLogin()){this.headerAdmin.linkWords.element.classList.add("active-link"),this.wrapperMainPages.element.classList.add("hide"),this.wrapperAdminPages.element.classList.remove("hide"),this.mainAdmin.innerHTML="";const e=this.idPage.substring(this.idPage.lastIndexOf("/")+1);this.pageWordsAdmin=new re(e),this.pageWordsAdmin.render(this.mainAdmin)}else this.mainWrapper.innerHTML="You are not logged in!",window.location.href="#categories"},this.routerPageCards=()=>{this.mainWrapper.innerHTML="",this.createPageCards(),this.pageCards.render(this.mainWrapper)},this.registerRouter=()=>{v.registerRouter("stat",this.routerStatisctics),v.registerRouter("categories",this.routerCategories),v.registerRouter("",this.routerCategories),v.registerRouter("admin-categories",this.routerAdminCategories),v.registerRouter("repeat",this.routerPageCards),c().then((e=>{e.forEach((e=>{v.registerRouter(`admin-categories/${e.nameRouter}`,this.routerAdminWords),v.registerRouter(`${e.nameRouter}`,this.routerPageCards)}))})),m.routerAdminWords=this.routerAdminWords},this.enableRouteChange=()=>{window.addEventListener("hashchange",this.onChangeHash)},this.onChangeHash=()=>{d.stopGame(),this.idPage=window.location.hash.slice(1),this.mainWrapper.innerHTML="",v.callRouter(this.idPage)},this.setActiveLinkToPageCards=()=>{if("repeat"!==this.idPage&&this.setActiveLink(Number(this.idPage)),"repeat"===this.idPage){const e=this.header.burgerMenu.navItems.items.length-1;this.setActiveLink(e)}},this.setActiveLinkToPageCategories=()=>{this.setActiveLink(0)},this.setActiveLinkToPageStatistics=()=>{this.setActiveLink()},this.onClickBtnLogin=()=>{d.isLogin()?(d.setLoginFalse(),window.localStorage.removeItem("loginData"),d.setLoginFalse(),this.header.btnLogOut.element.classList.add("hide"),this.header.btnAdminPanel.element.classList.add("hide")):this.loginForm.showForm()},this.linkLocalServer=()=>{window.open("https://github.com/Maks-T/server-for-efk","_blank")},this.welcomeMessage="<div><p>Если вы видите это сообщение, то нет связи с сервером!</p>\n  <p>Прошу установить на свой компьютер сервер локально.<br></p>\n  <p>Для это нужно перейти по ссылке GitHub и скачать сервер на свой компьютер<br></p>\n  <a href='https://github.com/Maks-T/server-for-efk' target='_blank'>https://github.com/Maks-T/server-for-efk</a>\n  <p>Следуйте инструкции на GitHub<br></p>\n  <p>Нажмите OK чтобы продолжить<br></p>\n  <p class=\"req\">Прошу проверить таск 19.07.2021г<br></p></div>\n  ",this.idPage=e,this.createAppElements(),this.setEventToElements()}setActiveLink(e){this.header.burgerMenu.navItems.items.forEach((e=>{e.classList.remove("active")})),(e||0===e)&&this.header.burgerMenu.navItems.items[e].classList.add("active")}run(){u().then((e=>{e?(d.setLoginTrue(),this.header.btnLogOut.element.classList.remove("hide"),this.header.btnAdminPanel.element.classList.remove("hide")):d.setLoginFalse()})),d.initStateStore(),this.registerRouter(),E.initStatistics().finally((()=>{this.container.append(this.wrapperMainPages.element),this.wrapperMainPages.element.append(this.header.element),this.wrapperMainPages.element.append(this.main),this.wrapperMainPages.element.append(this.loginForm.element),this.wrapperMainPages.element.append(this.footer.element),this.container.append(this.wrapperAdminPages.element),this.wrapperAdminPages.element.append(this.headerAdmin.element),this.wrapperAdminPages.element.append(this.mainAdmin),this.main.appendChild(this.mainWrapper),v.callRouter(this.idPage),this.enableRouteChange(),m.onClickBtnLogin=this.onClickBtnLogin}))}}(ie);window.onload=()=>{se.run()}})();